<!DOCTYPE html>
<html>
<head>
    <title>Test Notification API</title>
</head>
<body>
    <h1>Notification API Test</h1>
    <button onclick="testNotificationAPI()">Test API</button>
    <button onclick="setTestToken()">Set Test Token</button>
    <button onclick="clearToken()">Clear Token</button>
    <div id="output"></div>

    <script>
        const testToken = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiI2ODNhZmEyZWZkMTNiNDI0OTllYWVhMGQiLCJpYXQiOjE3NDk2NDEzOTMsImV4cCI6MTc0OTY0NDk5M30.GTQ8vrHoXb_6K2KKeYzX4evMPBZm3MMBM8uOhSy8qqU';
        
        function setTestToken() {
            localStorage.setItem('token', testToken);
            document.getElementById('output').innerHTML += '<p>Token set in localStorage</p>';
        }
        
        function clearToken() {
            localStorage.removeItem('token');
            document.getElementById('output').innerHTML += '<p>Token cleared from localStorage</p>';
        }
        
        async function testNotificationAPI() {
            const output = document.getElementById('output');
            output.innerHTML = '<p>Testing notification API...</p>';
            
            try {
                // Test count API
                const countResponse = await fetch('/api/notifications/count', {
                    headers: {
                        'Authorization': `Bearer ${testToken}`
                    }
                });
                
                const countData = await countResponse.json();
                output.innerHTML += `<p><strong>Count API:</strong> ${JSON.stringify(countData)}</p>`;
                
                // Test notifications list API
                const listResponse = await fetch('/api/notifications', {
                    headers: {
                        'Authorization': `Bearer ${testToken}`,
                        'Content-Type': 'application/json'
                    }
                });
                
                const listData = await listResponse.json();
                output.innerHTML += `<p><strong>List API Status:</strong> ${listResponse.status}</p>`;
                output.innerHTML += `<p><strong>List API Data:</strong> ${JSON.stringify(listData, null, 2)}</p>`;
                
                if (listData.data && listData.data.length > 0) {
                    output.innerHTML += `<p><strong>First notification:</strong> ${JSON.stringify(listData.data[0], null, 2)}</p>`;
                }
                
            } catch (error) {
                output.innerHTML += `<p><strong>Error:</strong> ${error.message}</p>`;
                console.error('Error:', error);
            }
        }
    </script>
</body>
</html>
